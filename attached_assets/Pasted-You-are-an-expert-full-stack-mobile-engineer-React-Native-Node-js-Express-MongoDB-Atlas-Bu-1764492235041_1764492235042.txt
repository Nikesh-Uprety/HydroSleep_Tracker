You are an expert full-stack mobile engineer (React Native + Node.js/Express + MongoDB Atlas).  
Build a complete production-ready mobile app and backend API based on the detailed specs below.

================================
ROLE & GOAL
================================
Act as:
- Lead React Native engineer
- Backend API architect (Node.js/Express)
- MongoDB data model designer
- UX engineer

Goal:
- Build a **health & habit tracking app** (sleep + water + goals) whose UI/UX matches the described mockup.
- Implement a secure backend using **Node.js/Express** with **MongoDB Atlas** as the database.
- Provide clean, well-structured, and well-commented code, plus a short README with run instructions.

================================
TECH STACK
================================
Frontend:
- React Native with Expo (TypeScript preferred)
- React Navigation (stack + bottom tabs)
- Axios (or Fetch wrapper) for HTTP
- State: React Query or simple Context + hooks (your choice, but keep it simple and clear)
- No paid libraries

Backend:
- Node.js + Express (TypeScript or modern JS with ES modules)
- MongoDB Atlas using Mongoose ODM
- JSON Web Tokens (JWT) for authentication
- bcrypt (or bcryptjs) for password hashing
- dotenv for environment variables
- Helmet + basic security middleware
- CORS enabled for the mobile app

Project structure:
- Two separate folders: `/mobile` and `/server`
- Each with its own package.json and README

================================
APP CONCEPT & MAIN FEATURES
================================
App name (placeholder): **HydroSleep Tracker**.

Key user capabilities:
1. Create an account and log in securely.
2. See a friendly **Dashboard** with cards for:
   - Water Intake
   - Sleep Tracker
   - Sleep Report
   - Goals
3. Track **sleep**:
   - View last night’s sleep duration.
   - See a detailed sleep report with:
     - Total sleep duration (e.g., “8h 05m”)
     - Percentages for Rested, REM, and Deep Sleep
     - Suggestion text.
4. Track **water intake**:
   - Log daily water consumption (e.g., in liters or ml).
   - See a weekly bar chart with 7 days and a banner “7 Day Goal Met!” when goal is reached.
5. Manage **daily goals**:
   - Exercise regularly (# times/week)
   - Drink water (L per day)
   - Improve sleep (hours/night)
   - Show them in a simple list like:
       - Exercise Regularly – 4x
       - Drink Water – 3L
       - Improve Sleep – 8h
6. All data is stored per user in **MongoDB Atlas** (no shared data across users).

================================
UI / UX – MATCH THE MOCKUP
================================
Recreate the UI based on this description of the provided image:

1. **Login / Welcome Screen**
   - White background.
   - Large illustration at the top (person with a big glass of water – you can use any free vector or placeholder).
   - Title text: “Welcome Back!”
   - Fields:
     - Email (text input)
     - Password (password input)
   - Primary button: **Log In** (full-width, blue, rounded corners).
   - Under the button, small text: “Don’t have an account? Sign Up” with the Sign Up part tappable.
   - On success -> navigate to Dashboard.
   - Provide a separate **Sign Up** screen with fields: Name, Email, Password, Confirm Password.

2. **Dashboard Screen**
   - Title area at top:
     - “Dashboard”
     - Subtext: “Hello, [UserName]”
   - Below, vertical list of **card items**:
     - “Water Intake – Awesome Efforts”
     - “Sleep Tracker”
     - “Sleep Tracker” (you can treat the second one as “Sleep Report” if you want)
     - “Goals”
   - Each card:
     - Rounded white card with a small icon/illustration on left and a right arrow chevron on the right.
   - Bottom **tab bar** (4 tabs):
     - Home (Dashboard)
     - Water
     - Sleep
     - Goals
   - Tapping cards or tabs navigates to dedicated screens.

3. **Sleep Report Screen (Simple)**
   - Title: “Sleep Report” + subtitle “Last Night”.
   - Large card in the middle:
     - Illustration of a person sleeping.
     - Big time label: e.g., “7h 55m”.
     - Subtext: e.g., “Didn’t move in bed”.
   - Button at bottom of card: **Stop Tracking** (blue, rounded).
   - For functionality: treat sleep tracking as logging a completed sleep session (user can stop and save).

4. **Water Report Screen**
   - Title: “Water Report”.
   - Subtitle: “Week of [date]” (backend should send the start date of the displayed week).
   - Banner text: “7 Day Goal Met!” when weekly goal is achieved; otherwise something like “Keep Going”.
   - Display a simple **7-bar chart** representing daily water intake vs goal:
     - You can implement with a simple custom bar chart using `View` widths/heights (no need for heavy chart libraries).
   - Under the chart, a “Tips” section:
     - “The more you drink regularly, the better your hydration.” (example text from mockup).

5. **Sleep Report Screen (Detailed)**
   - Title: “Sleep Report – Last Night”.
   - Top: circular or badge-style illustration (medal or ribbon).
   - Text: “Great Job! 8h 05m”.
   - Row of three round stats under it:
     - “90% – Rested”
     - “25% – REM”
     - “20% – Deep Sleep”
   - Under that, “Suggestions” section:
     - Example text: “A consistent sleep schedule helps your body recover.”
   - Values should be pulled from backend data for last sleep entry (with some simple logic to compute percentages).

6. **Goals Screen**
   - Title: “Goals”.
   - Subtitle: “Daily”.
   - Simple list of goal rows:
     - “Exercise Regularly – 4x”
     - “Drink Water – 3L”
     - “Improve Sleep – 8h”
   - Each row:
     - Left: goal label.
     - Right: numeric/units in blue.
   - Tapping a row should open a simple modal or secondary screen to edit that goal.

Design guidelines:
- Clean, minimal, iOS-style.
- Primary color: a mid/bright blue (e.g., #2563EB or similar).
- Rounded corners for buttons and cards.
- Use system fonts (no custom paid fonts).
- Respect safe areas on modern devices.

================================
DATA MODEL (MONGODB + MONGOOSE)
================================
Design Mongoose schemas (at minimum):

1. **User**
   - _id: ObjectId
   - name: string (required)
   - email: string (required, unique, lowercase)
   - passwordHash: string (required, bcrypt hashed)
   - createdAt: Date (default now)
   - updatedAt: Date

2. **Goal**
   - _id: ObjectId
   - userId: ObjectId (ref User, required)
   - type: string enum ['exercise', 'water', 'sleep']
   - value: number (e.g., 4, 3, 8)
   - unit: string (e.g., 'times/week', 'L/day', 'hours/night')
   - createdAt, updatedAt

3. **SleepEntry**
   - _id: ObjectId
   - userId: ObjectId (ref User, required)
   - date: Date (the night’s date)
   - durationMinutes: number
   - restedPercent: number (0–100)
   - remPercent: number (0–100)
   - deepSleepPercent: number (0–100)
   - notes: string (optional)
   - createdAt, updatedAt

4. **WaterLog**
   - _id: ObjectId
   - userId: ObjectId (ref User, required)
   - date: Date (only date portion matters)
   - amountMl: number
   - createdAt, updatedAt

Backend should be structured so it’s easy to extend.

================================
API DESIGN (JWT PROTECTED)
================================
Base URL example: `http://localhost:4000/api`

Authentication:
- `POST /auth/register`
  - Body: { name, email, password }
  - Validate email uniqueness, hash password with bcrypt.
  - Return: { user: {id, name, email}, token }

- `POST /auth/login`
  - Body: { email, password }
  - Verify credentials.
  - Return: { user: {id, name, email}, token }

- Use JWT in `Authorization: Bearer <token>` header for all other endpoints.

Goals:
- `GET /goals` – return current goals for the logged-in user (three goals by default).
- `PUT /goals/:type` – update a specific goal (exercise, water, or sleep).

Sleep:
- `GET /sleep/latest` – returns the most recent SleepEntry and a human-friendly suggestion.
- `GET /sleep/week?start=<ISO>` – returns list for a 7-day range.
- `POST /sleep`
  - Body: { date, durationMinutes, restedPercent, remPercent, deepSleepPercent, notes? }
- `PUT /sleep/:id`
- `DELETE /sleep/:id` (optional).

Water:
- `GET /water/week?start=<ISO>` – return 7 days of water totals & whether 7-day goal is met.
- `POST /water`
  - Body: { date, amountMl }

Dashboard summary:
- `GET /dashboard/summary`
  - Returns combined info for dashboard:
    - userName
    - today’s water vs goal, and whether 7-day goal met
    - last night sleep duration & percentages
    - current goals

================================
FRONTEND LOGIC & FLOWS
================================
Authentication flow:
- If no token -> show Auth stack (Login + Sign Up).
- After successful login/register -> save token securely (for now AsyncStorage is OK) and switch to App stack.
- Auto-login if token exists and is valid (simple check).

Navigation:
- Use React Navigation with:
  - AuthStack: LoginScreen, SignUpScreen
  - AppStack:
    - BottomTabNavigator: Home, Water, Sleep, Goals
    - Each tab has its main screen (Dashboard, WaterReport, SleepReport, Goals).
    - Optionally extra screens (e.g., EditGoalScreen) accessible via stack navigation.

Data fetching:
- On Dashboard load, call `/dashboard/summary`.
- On Water tab, call `/water/week`.
- On Sleep tab:
  - Show both the simple card (7h 55m & Stop Tracking) and the detailed stats using `/sleep/latest`.
- On Goals tab, call `/goals` and display three goals.

UI behaviour:
- “Stop Tracking” button:
  - For now, open a small modal where user can enter:
    - Sleep start time, end time, or directly total hours and minutes.
  - On submit, call `POST /sleep`.

- Water logging:
  - Provide a simple “Add Water” button (e.g. +250ml / +500ml) somewhere on Water screen.
  - Updating the chart after logging.

- Goals editing:
  - Tap on a goal -> open a small modal with a numeric input to adjust value.
  - Save calls `PUT /goals/:type` and refresh data.

Error handling:
- Show friendly error toasts/alerts on network errors or validation errors.
- Validate inputs (non-empty email/password, positive numbers, etc.).

================================
NON-FUNCTIONAL REQUIREMENTS
================================
- Use environment variables for:
  - Backend: `MONGODB_URI`, `JWT_SECRET`, `PORT`.
  - Mobile: base API URL (for development can be a config file constant).
- Add simple logging (console or small logger).
- Backend must handle CORS for the mobile app origin.
- Add comments and JSDoc/TSDoc where helpful.
- Provide seed logic (optional):
  - On first user login, create default goals if none exist (exercise 4x/week, water 3L/day, sleep 8h/night).

================================
DELIVERABLES
================================
1. `/server` folder with:
   - package.json
   - src/index.(ts|js)
   - routes, controllers, models
   - JWT + auth middleware
   - README with:
     - How to install dependencies
     - How to set environment variables
     - How to run the dev server

2. `/mobile` folder with:
   - Expo React Native app in TypeScript (preferred)
   - Screen components, navigation setup, API client
   - Styles matching the described UI mockups
   - README with:
     - How to install dependencies
     - How to run with `expo start`
     - How to configure API base URL

3. Ensure the app runs end-to-end:
   - User can register, log in, and see personalized dashboard.
   - Sleep, water, and goals data persist correctly in MongoDB Atlas.
   - UI closely resembles the described layout and text.


You already built the initial React Native + Expo + Node.js/Express + MongoDB Atlas app from my previous prompt (HydroSleep Tracker).

Now I want you to MODIFY and EXTEND the existing codebase with the following features, without breaking the current functionality.

================================
CONTEXT (EXISTING APP)
================================
- Tech stack:
  - Frontend: React Native with Expo, React Navigation, JWT auth, AsyncStorage token.
  - Backend: Node.js + Express + Mongoose + MongoDB Atlas, JWT auth.
- Current features:
  - Auth (register/login).
  - Dashboard with cards for Water Intake, Sleep Tracker/Report, and Goals.
  - Goals screen shows default goals: Exercise Regularly, Drink Water, Improve Sleep.
  - Sleep and Water tracking screens with weekly data and reports.

Do NOT regenerate the whole project from scratch.
Instead, UPDATE and EXTEND the existing mobile and server code.

================================
TASK 1 – ACCOUNT / PROFILE SCREEN + LOGOUT
================================

FRONTEND
1. Add a new **Account / Profile screen**:
   - Accessible either as:
     - A new tab in the bottom tab bar named “Account”, OR
     - A profile/user icon button in the top-right of the main Dashboard that navigates to the Account screen.
   - On this screen show:
     - User profile image (avatar).
     - Username / display name.
     - Email.
     - Buttons or editable inputs to:
       - Change profile image.
       - Edit username.
       - Edit email.
       - Change password.
       - Log out.

2. **Profile image handling**:
   - Allow the user to pick an image from the device library (use Expo ImagePicker or similar).
   - Show the chosen image in a circular avatar component.
   - On save, upload the image (or its URL / base64 string) to the backend via a dedicated API endpoint and store the reference in MongoDB.

3. **Edit username & email**:
   - Provide a simple form with validation.
   - When the user taps “Save changes”, call the backend update endpoint.
   - On success, update local state and show a confirmation message.

4. **Change password**:
   - Provide inputs:
     - Current password.
     - New password.
     - Confirm new password.
   - Call backend change-password endpoint.
   - Handle error states (wrong current password, password too short, etc).

5. **Logout button**:
   - Add a prominent “Log Out” button on the Account screen.
   - On tap:
     - Clear the JWT token from AsyncStorage (or the storage mechanism currently used).
     - Clear any user-related state.
     - Navigate back to the Auth stack (Login screen).

BACKEND
1. Update the **User model** to support profile data:
   - Add fields such as:
     - `profileImageUrl: string` (optional).
     - `displayName: string` (can default to the name used at registration).
   - Ensure the schema has timestamps.

2. Add new **user profile routes** (JWT protected):
   - `GET /user/me`
     - Returns the logged-in user’s profile: { id, name/displayName, email, profileImageUrl, createdAt }.
   - `PUT /user/me`
     - Allows updating `displayName` and `email` (with validation and uniqueness check for email).
   - `PUT /user/me/password`
     - Body: { currentPassword, newPassword }.
     - Verify current password with bcrypt.
     - If correct, hash the new password and save.
   - `PUT /user/me/avatar`
     - Accepts an image URL or base64 string (whichever is easier for you to implement).
     - Saves it as `profileImageUrl` on the user document.

3. Make sure all these routes:
   - Require a valid JWT via auth middleware.
   - Return proper status codes and JSON error messages.

================================
TASK 2 – ENHANCED GOALS: ADD & REMOVE CUSTOM GOALS
================================

GOAL REQUIREMENTS
- Existing default goals:
  - Exercise Regularly – 4x
  - Drink Water – 3L
  - Improve Sleep – 8h
- New requirement: user can **add extra custom goals** and **remove non-default goals**.

BACKEND
1. Extend the **Goal model**:
   - Add fields:
     - `label: string` (e.g., “Meditate”, “Read a book”).
     - `isDefault: boolean` (true for the three system goals, false for user-created ones).
   - Existing enum `type` can still be used for special-case logic (exercise/water/sleep), but custom goals can have `type: 'custom'`.

2. Create/Update endpoints:
   - `GET /goals`
     - Returns all goals belonging to the user (both default and custom).
   - `POST /goals`
     - Create a new custom goal for the logged-in user.
     - Body example: { label, value, unit }.
     - Set `isDefault: false` and `type: 'custom'` for these.
   - `DELETE /goals/:id`
     - Allow deleting only non-default goals.
     - If `isDefault` is true, return an error or simply ignore deletion to protect the three base goals.
   - Update existing `PUT /goals/:type` or add `PUT /goals/:id` as necessary:
     - Allow updating values/units for both default and custom goals.

FRONTEND
1. **Goals screen UI update**:
   - List all goals (default + custom).
   - Default goals should be visually distinct or locked from deletion.
   - Add a button like “+ Add Goal”.
   - For each non-default goal, show a small “trash” or “remove” icon to delete it.

2. **Add Goal flow**:
   - Tapping “+ Add Goal” opens a modal or new screen with:
     - Goal name/label (text input).
     - Target value (number).
     - Unit (string, e.g., “min/day”, “pages/day”, “L/day”).
   - Validate fields and call `POST /goals`.
   - Refresh goals list after success.

3. **Remove Goal flow**:
   - Tapping the delete icon for a custom goal shows a confirmation dialog.
   - On confirm, call `DELETE /goals/:id`.
   - Refresh goals list after success.
   - Do NOT show delete option for `isDefault === true`.

================================
TASK 3 – NEW ANALYTICS DASHBOARD (GRAPH VIEW)
================================

Create a new **Analytics** or **Insights** screen that shows a modern graphical overview of the user’s stats.

FRONTEND
1. Add navigation:
   - Either:
     - Add a new tab called “Analytics” in the bottom tab navigator, OR
     - Add a “View Analytics” card/button on the main Dashboard that navigates to an Analytics screen.
   - Name the screen “Analytics” or “Insights”.

2. Analytics screen design:
   - Clean, modern layout with white background and cards.
   - Sections (example, adjust as needed based on data returned by backend):
     1. **Weekly Sleep Duration** – small line chart or area chart showing hours of sleep for the past 7 days.
     2. **Weekly Water Intake** – bar chart for last 7 days showing amount vs. goal.
     3. **Goal Progress Overview** – e.g., a donut/pie chart or a horizontal bar that shows percentage of days in the week where goals were met.
   - Use a lightweight chart solution:
     - You may use `react-native-svg` + custom charts, or a free library like `react-native-chart-kit` if compatible with Expo.
   - Each section should have a header and brief description underneath.

BACKEND
1. Add a new endpoint:
   - `GET /analytics/summary`
   - It should be JWT-protected and accept optional query params like `range=7d` (for now default to last 7 days).

2. The endpoint should return data structured for easy charting, for example:
   ```json
   {
     "sleep": {
       "days": ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
       "hours": [7.5, 6.0, 8.0, 7.0, 8.5, 7.8, 6.5],
       "average": 7.34
     },
     "water": {
       "days": ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
       "liters": [2.5, 3.0, 2.0, 3.2, 3.0, 2.8, 2.5],
       "dailyGoalLiters": 3,
       "goalMetCount": 4
     },
     "goals": {
       "totalGoals": 5,
       "completedToday": 3,
       "weeklyCompletionRatePercent": 72
     }
   }
Use SleepEntry and WaterLog collections to compute the last 7 days statistics per user.

Use Goals to determine completion rates (you can define a simple completion rule such as “met if actual >= goal”).

Perform all calculations server-side so the frontend only has to render graphs.

================================
GENERAL REQUIREMENTS

Integrate new features without breaking existing ones.

Keep code consistent with existing style (TypeScript/JavaScript, folder structure).

Add/update any necessary types/interfaces.

Add error handling and basic form validation on the frontend.

Update README(s) if needed to mention the new endpoints and screens.